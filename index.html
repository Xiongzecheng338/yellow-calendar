<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玄机黄历 · 洞察天机</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cinnabar: '#C41E3A',
                        gold: '#D4AF37',
                        ink: '#1A1A1A',
                        bronze: '#CD7F32',
                        jade: '#00A86B',
                        vermilion: '#E34234',
                        obsidian: '#0B0B0B',
                        parchment: '#F5E6D3',
                        silk: '#FFFDD0',
                        mystic: '#2D1B4E',
                        azure: '#007FFF',
                        chaos: '#1A0A2E',
                    },
                    fontFamily: {
                        ancient: ['Ma Shan Zheng', 'cursive'],
                        seal: ['ZCOOL XiaoWei', 'serif'],
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'ZCOOL XiaoWei', serif;
            background: radial-gradient(ellipse at center, #1a0a0a 0%, #0a0505 100%);
            overflow-x: hidden;
        }
        
        .ancient-font { font-family: 'Ma Shan Zheng', cursive; }
        
        /* 混沌初开动画 */
        @keyframes chaosToOrder {
            0% { opacity: 0; filter: blur(50px); transform: scale(2); }
            50% { opacity: 1; filter: blur(20px); transform: scale(1.2); }
            100% { opacity: 1; filter: blur(0); transform: scale(1); }
        }
        
        @keyframes skyEarthSplit {
            0% { transform: scaleY(0); opacity: 0; }
            50% { transform: scaleY(1); opacity: 0.5; }
            100% { transform: scaleY(1); opacity: 1; }
        }
        
        @keyframes floatCloud {
            0%, 100% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(10px) translateY(-5px); }
            50% { transform: translateX(20px) translateY(0); }
            75% { transform: translateX(10px) translateY(5px); }
        }
        
        @keyframes pulseGlow {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(212, 175, 55, 0.4),
                            0 0 60px rgba(212, 175, 55, 0.2);
            }
            50% { 
                box-shadow: 0 0 50px rgba(212, 175, 55, 0.6),
                            0 0 100px rgba(212, 175, 55, 0.4);
            }
        }
        
        @keyframes rotateBagua {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes reverseRotate {
            from { transform: rotate(360deg); }
            to { transform: rotate(0deg); }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.8); }
        }
        
        @keyframes flowQi {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes rippleExpand {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }
        
        .chaos-enter { animation: chaosToOrder 3s ease-out forwards; }
        .sky-earth { animation: skyEarthSplit 2s ease-out forwards; }
        .float-cloud { animation: floatCloud 15s ease-in-out infinite; }
        .pulse-glow { animation: pulseGlow 3s ease-in-out infinite; }
        .bagua-rotate { animation: rotateBagua 60s linear infinite; }
        .bagua-reverse { animation: reverseRotate 45s linear infinite; }
        .star { animation: twinkle 3s ease-in-out infinite; }
        .flow-qi { animation: flowQi 10s ease infinite; background-size: 200% 200%; }
        .breathe { animation: breathe 4s ease-in-out infinite; }
        .slide-in { animation: slideIn 0.6s ease-out forwards; }
        
        /* 玻璃态 */
        .glass {
            background: rgba(26, 10, 10, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(212, 175, 55, 0.15);
        }
        
        .glass-dark {
            background: rgba(11, 11, 11, 0.85);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        /* 自定义按钮图案 - 玉佩形状 */
        .jade-pendant {
            position: relative;
            background: linear-gradient(135deg, rgba(0, 168, 107, 0.2), rgba(212, 175, 55, 0.2));
            clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 80%, 80% 100%, 20% 100%, 0% 80%, 0% 20%);
            transition: all 0.4s ease;
        }
        
        .jade-pendant:hover {
            background: linear-gradient(135deg, rgba(0, 168, 107, 0.4), rgba(212, 175, 55, 0.4));
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
        }
        
        /* 卷轴形状 */
        .scroll-shape {
            position: relative;
            background: linear-gradient(180deg, rgba(212, 175, 55, 0.15), rgba(139, 105, 20, 0.15));
            border-radius: 20px;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }
        
        .scroll-shape::before, .scroll-shape::after {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 110%;
            height: 15px;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.5), transparent);
            border-radius: 10px;
        }
        
        .scroll-shape::before { top: -8px; }
        .scroll-shape::after { bottom: -8px; }
        
        /* 八卦按钮 */
        .bagua-btn {
            position: relative;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, rgba(212, 175, 55, 0.3), rgba(0, 0, 0, 0.5), rgba(212, 175, 55, 0.3), rgba(0, 0, 0, 0.5), rgba(212, 175, 55, 0.3), rgba(0, 0, 0, 0.5), rgba(212, 175, 55, 0.3), rgba(0, 0, 0, 0.5));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.5s ease;
        }
        
        .bagua-btn::before {
            content: '';
            position: absolute;
            inset: 5px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(26, 10, 10, 0.9), rgba(11, 11, 11, 1));
        }
        
        .bagua-btn:hover {
            transform: scale(1.1) rotate(180deg);
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.5);
        }
        
        /* 祥云边框 */
        .cloud-border {
            position: relative;
            border: none;
        }
        
        .cloud-border::before {
            content: '';
            position: absolute;
            inset: -3px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='20' viewBox='0 0 40 20'%3E%3Cpath d='M5 15 Q10 5 20 10 Q30 15 35 5' stroke='%23D4AF37' fill='none' stroke-width='1' opacity='0.5'/%3E%3C/svg%3E");
            border-radius: 20px;
            z-index: -1;
        }
        
        /* 滚动条 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1a0a0a; }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, #D4AF37, #8B6914); 
            border-radius: 3px; 
        }
        
        /* 模态框 */
        .modal-overlay {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.8);
        }
        
        /* 文字发光 */
        .text-glow {
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5),
                         0 0 20px rgba(212, 175, 55, 0.3);
        }
        
        /* 能量流动背景 */
        .energy-flow {
            background: linear-gradient(-45deg, rgba(196, 30, 58, 0.1), rgba(212, 175, 55, 0.1), rgba(0, 168, 107, 0.1), rgba(0, 127, 255, 0.1));
            background-size: 400% 400%;
            animation: flowQi 15s ease infinite;
        }
        
        /* 涟漪效果 */
        .ripple {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(212, 175, 55, 0.5);
            animation: rippleExpand 2s ease-out infinite;
        }
    </style>
</head>
<body class="min-h-screen text-parchlet">

    <!-- ========== 混沌初开入口 ========== -->
    <div id="chaosEntry" class="fixed inset-0 z-50 flex items-center justify-center bg-chaos overflow-hidden">
        <!-- 混沌粒子 -->
        <div id="chaosParticles" class="absolute inset-0"></div>
        
        <!-- 盘古开天动画 -->
        <div class="relative w-full h-full flex items-center justify-center">
            <!-- 天地分离效果 -->
            <div id="skyLayer" class="absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-chaos to-transparent opacity-0"></div>
            <div id="earthLayer" class="absolute bottom-0 left-0 right-0 h-1/2 bg-gradient-to-t from-obsidian to-transparent opacity-0"></div>
            
            <!-- 核心八卦 -->
            <div id="coreBagua" class="relative chaos-enter" style="animation-delay: 0.5s;">
                <!-- 外层光环 -->
                <div class="absolute inset-0 rounded-full pulse-glow"></div>
                
                <!-- 八卦旋转层 -->
                <div class="absolute inset-0 bagua-rotate">
                    <svg viewBox="0 0 200 200" class="w-80 h-80 md:w-96 md:h-96">
                        <defs>
                            <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#D4AF37" />
                                <stop offset="50%" style="stop-color:#8B6914" />
                                <stop offset="100%" style="stop-color:#D4AF37" />
                            </linearGradient>
                        </defs>
                        <!-- 外圈 -->
                        <circle cx="100" cy="100" r="98" fill="none" stroke="url(#goldGrad)" stroke-width="1" opacity="0.6"/>
                        <circle cx="100" cy="100" r="90" fill="none" stroke="url(#goldGrad)" stroke-width="0.5" opacity="0.4"/>
                        
                        <!-- 八卦符号 -->
                        <text x="100" y="8" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☰</text>
                        <text x="170" y="38" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☱</text>
                        <text x="195" y="105" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☲</text>
                        <text x="170" y="175" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☳</text>
                        <text x="100" y="198" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☷</text>
                        <text x="30" y="175" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☶</text>
                        <text x="5" y="105" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☵</text>
                        <text x="30" y="38" text-anchor="middle" fill="#D4AF37" font-size="18" class="ancient-font">☴</text>
                    </svg>
                </div>
                
                <!-- 中层反向旋转 -->
                <div class="absolute inset-8 bagua-reverse">
                    <svg viewBox="0 0 200 200" class="w-full h-full">
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#D4AF37" stroke-width="0.5" opacity="0.3"/>
                        <!-- 二十四节气简化 -->
                        <g fill="#D4AF37" opacity="0.4" font-size="8">
                            ${Array.from({length: 24}, (_, i) => {
                                const angle = (i * 15 - 90) * Math.PI / 180;
                                const x = 100 + 70 * Math.cos(angle);
                                const y = 100 + 70 * Math.sin(angle);
                                return `<text x="${x}" y="${y}" text-anchor="middle">·</text>`;
                            }).join('')}
                        </g>
                    </svg>
                </div>
                
                <!-- 太极图 -->
                <div class="absolute inset-16 rounded-full overflow-hidden breathe">
                    <svg viewBox="0 0 100 100" class="w-full h-full">
                        <circle cx="50" cy="50" r="50" fill="#0B0B0B"/>
                        <path d="M50 0 A50 50 0 0 1 50 100 A25 25 0 0 1 50 50 A25 25 0 0 0 50 0" fill="#D4AF37"/>
                        <circle cx="50" cy="25" r="8" fill="#0B0B0B"/>
                        <circle cx="50" cy="75" r="8" fill="#D4AF37"/>
                    </svg>
                </div>
                
                <!-- 进入按钮 -->
                <button onclick="enterApp()" class="absolute inset-0 flex items-center justify-center group z-10">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gold/20 rounded-full blur-xl group-hover:bg-gold/40 transition-all duration-500 scale-0 group-hover:scale-150"></div>
                        <div class="relative px-10 py-5 bg-gradient-to-br from-gold/40 to-bronze/40 rounded-full border-2 border-gold/60 backdrop-blur-sm group-hover:border-gold transition-all duration-300">
                            <span class="ancient-font text-3xl text-gold text-glow">开天辟地</span>
                        </div>
                    </div>
                </button>
            </div>
        </div>
        
        <!-- 底部文字 -->
        <div class="absolute bottom-8 text-center chaos-enter" style="animation-delay: 1.5s;">
            <h1 class="ancient-font text-5xl md:text-6xl text-gold text-glow mb-3">玄机黄历</h1>
            <p class="text-bronze/70 tracking-widest text-sm">混沌初开 · 天地玄黄 · 宇宙洪荒</p>
        </div>
    </div>

    <!-- ========== 主界面 ========== -->
    <div id="mainApp" class="hidden min-h-screen energy-flow">
        <!-- 动态背景层 -->
        <div id="bgStars" class="fixed inset-0 pointer-events-none z-0"></div>
        <div id="bgClouds" class="fixed inset-0 pointer-events-none z-0 opacity-30"></div>
        
        <!-- 顶部导航 -->
        <header class="relative z-20 glass-dark sticky top-0">
            <div class="container mx-auto px-4 py-3">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-full bg-gold/20 flex items-center justify-center pulse-glow">
                            <i class="fas fa-yin-yang text-gold text-lg"></i>
                        </div>
                        <div>
                            <h1 class="ancient-font text-xl text-gold text-glow">玄机黄历</h1>
                        </div>
                    </div>
                    <div class="text-right">
                        <div id="headerDate" class="text-parchment text-sm"></div>
                        <div id="headerLunar" class="text-bronze text-xs"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- 主内容 -->
        <main class="relative z-10 container mx-auto px-4 py-6">
            
            <!-- 今日概览 - 简化版 -->
            <section class="mb-8 slide-in">
                <div class="glass rounded-3xl p-6 pulse-glow">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-center">
                        <!-- 日期 -->
                        <div class="text-center md:border-r border-gold/20">
                            <div id="todaySolar" class="ancient-font text-3xl text-gold text-glow"></div>
                            <div id="todayLunar" class="text-bronze text-sm mt-1"></div>
                        </div>
                        
                        <!-- 卦象 -->
                        <div class="text-center md:border-r border-gold/20">
                            <div class="text-bronze text-xs">今日卦象</div>
                            <div id="todayGua" class="ancient-font text-4xl text-gold text-glow my-1"></div>
                            <div id="todayGuaName" class="text-parchment/70 text-sm"></div>
                        </div>
                        
                        <!-- 宜忌 -->
                        <div class="text-center md:border-r border-gold/20">
                            <div class="flex justify-center gap-4">
                                <div>
                                    <div class="text-jade text-xs">宜</div>
                                    <div id="quickYi" class="text-jade/80 text-sm mt-1"></div>
                                </div>
                                <div>
                                    <div class="text-cinnabar text-xs">忌</div>
                                    <div id="quickJi" class="text-cinnabar/80 text-sm mt-1"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 每日一言 -->
                        <div class="text-center">
                            <i class="fas fa-quote-left text-gold/30 text-sm mb-2"></i>
                            <p id="dailyQuote" class="text-parchment/70 text-sm italic"></p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 四大模块入口 - 使用特殊图案按钮 -->
            <section class="mb-8">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    
                    <!-- 天时模块 - 圆形八卦按钮 -->
                    <button onclick="openModule('tianshi')" class="group relative">
                        <div class="bagua-btn mx-auto">
                            <div class="relative z-10 text-center">
                                <i class="fas fa-sun text-3xl text-gold mb-2 group-hover:scale-110 transition-transform"></i>
                                <div class="text-gold ancient-font text-xl">天时</div>
                                <div class="text-parchment/50 text-xs mt-1">历法卦象</div>
                            </div>
                        </div>
                        <div class="absolute -bottom-2 left-1/2 -translate-x-1/2 w-16 h-1 bg-gradient-to-r from-transparent via-gold/50 to-transparent rounded-full"></div>
                    </button>
                    
                    <!-- 地利模块 - 方形罗盘按钮 -->
                    <button onclick="openModule('dili')" class="group relative">
                        <div class="w-28 h-28 mx-auto rounded-2xl bg-gradient-to-br from-jade/20 to-gold/20 border-2 border-jade/30 flex items-center justify-center transform rotate-45 hover:rotate-0 transition-all duration-500 hover:scale-110 hover:shadow-lg hover:shadow-jade/30">
                            <div class="transform -rotate-45 group-hover:rotate-0 transition-all duration-500 text-center">
                                <i class="fas fa-compass text-3xl text-jade mb-2"></i>
                                <div class="text-jade ancient-font text-xl">地利</div>
                                <div class="text-parchment/50 text-xs mt-1">风水方位</div>
                            </div>
                        </div>
                    </button>
                    
                    <!-- 人和模块 - 玉佩形状按钮 -->
                    <button onclick="openModule('renhe')" class="group relative">
                        <div class="jade-pendant w-28 h-28 mx-auto flex items-center justify-center">
                            <div class="text-center">
                                <i class="fas fa-users text-3xl text-gold mb-2 group-hover:scale-110 transition-transform"></i>
                                <div class="text-gold ancient-font text-xl">人和</div>
                                <div class="text-parchment/50 text-xs mt-1">命理运势</div>
                            </div>
                        </div>
                    </button>
                    
                    <!-- 玄机模块 - 卷轴形状按钮 -->
                    <button onclick="openModule('xuanji')" class="group relative">
                        <div class="scroll-shape w-28 h-28 mx-auto flex items-center justify-center py-4">
                            <div class="text-center">
                                <i class="fas fa-scroll text-3xl text-gold mb-2 group-hover:scale-110 transition-transform"></i>
                                <div class="text-gold ancient-font text-xl">玄机</div>
                                <div class="text-parchment/50 text-xs mt-1">占卜解梦</div>
                            </div>
                        </div>
                    </button>
                </div>
            </section>

            <!-- 今日详情标签页 -->
            <section class="mb-8">
                <div class="glass rounded-3xl overflow-hidden">
                    <!-- 标签导航 -->
                    <div class="flex border-b border-gold/20 overflow-x-auto">
                        <button onclick="switchTab('overview')" class="tab-btn active flex-1 py-4 text-center text-gold hover:bg-gold/10 transition-all border-b-2 border-gold" data-tab="overview">
                            <i class="fas fa-eye mr-2"></i>今日总览
                        </button>
                        <button onclick="switchTab('wuxing')" class="tab-btn flex-1 py-4 text-center text-parchment/70 hover:text-gold hover:bg-gold/10 transition-all border-b-2 border-transparent" data-tab="wuxing">
                            <i class="fas fa-fire mr-2"></i>五行能量
                        </button>
                        <button onclick="switchTab('zodiac')" class="tab-btn flex-1 py-4 text-center text-parchment/70 hover:text-gold hover:bg-gold/10 transition-all border-b-2 border-transparent" data-tab="zodiac">
                            <i class="fas fa-dragon mr-2"></i>生肖运势
                        </button>
                        <button onclick="switchTab('blessing')" class="tab-btn flex-1 py-4 text-center text-parchment/70 hover:text-gold hover:bg-gold/10 transition-all border-b-2 border-transparent" data-tab="blessing">
                            <i class="fas fa-hands-praying mr-2"></i>祈福许愿
                        </button>
                    </div>
                    
                    <!-- 标签内容 -->
                    <div id="tabContent" class="p-6">
                        <!-- 默认显示总览 -->
                    </div>
                </div>
            </section>

            <!-- 快捷功能 -->
            <section class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button onclick="openModule('history')" class="glass rounded-xl p-4 text-center hover:bg-gold/10 transition-all group">
                    <i class="fas fa-landmark text-2xl text-bronze mb-2 group-hover:scale-110 transition-transform"></i>
                    <div class="text-gold text-sm">历史今日</div>
                </button>
                <button onclick="openModule('festival')" class="glass rounded-xl p-4 text-center hover:bg-gold/10 transition-all group">
                    <i class="fas fa-calendar-day text-2xl text-cinnabar mb-2 group-hover:scale-110 transition-transform"></i>
                    <div class="text-gold text-sm">节日节气</div>
                </button>
                <button onclick="openModule('health')" class="glass rounded-xl p-4 text-center hover:bg-gold/10 transition-all group">
                    <i class="fas fa-heart-pulse text-2xl text-jade mb-2 group-hover:scale-110 transition-transform"></i>
                    <div class="text-gold text-sm">养生之道</div>
                </button>
                <button onclick="openModule('culture')" class="glass rounded-xl p-4 text-center hover:bg-gold/10 transition-all group">
                    <i class="fas fa-book-open text-2xl text-azure mb-2 group-hover:scale-110 transition-transform"></i>
                    <div class="text-gold text-sm">国学经典</div>
                </button>
            </section>
        </main>

        <!-- 页脚 -->
        <footer class="relative z-10 text-center py-6 border-t border-gold/10 mt-8">
            <p class="text-gold/40 text-sm">玄机黄历 · 传承千年智慧</p>
        </footer>
    </div>

    <!-- ========== 模态框 ========== -->
    <div id="modalOverlay" class="fixed inset-0 z-50 hidden modal-overlay flex items-center justify-center p-4 overflow-y-auto">
        <div id="modalContent" class="glass-dark rounded-3xl w-full max-w-5xl my-8 overflow-hidden">
            <div class="flex items-center justify-between p-6 border-b border-gold/20">
                <h2 id="modalTitle" class="ancient-font text-2xl text-gold text-glow"></h2>
                <button onclick="closeModal()" class="w-10 h-10 rounded-full bg-gold/10 hover:bg-gold/20 flex items-center justify-center transition-all">
                    <i class="fas fa-times text-gold"></i>
                </button>
            </div>
            <div id="modalBody" class="p-6 overflow-y-auto" style="max-height: 70vh;"></div>
        </div>
    </div>

    <script>
        // ==================== 数据定义 ====================
        const tianGan = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
        const diZhi = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
        const shengXiao = ['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'];
        const lunarMonths = ['正', '二', '三', '四', '五', '六', '七', '八', '九', '十', '冬', '腊'];
        const lunarDays = ['初一', '初二', '初三', '初四', '初五', '初六', '初七', '初八', '初九', '初十',
                          '十一', '十二', '十三', '十四', '十五', '十六', '十七', '十八', '十九', '二十',
                          '廿一', '廿二', '廿三', '廿四', '廿五', '廿六', '廿七', '廿八', '廿九', '三十'];
        
        const bagua = ['乾', '坤', '震', '巽', '坎', '离', '艮', '兑'];
        const baguaName = {
            '乾': '乾为天', '坤': '坤为地', '震': '震为雷', '巽': '巽为风',
            '坎': '坎为水', '离': '离为火', '艮': '艮为山', '兑': '兑为泽'
        };
        const guaCi = {
            '乾': '天行健，君子以自强不息。利贞，元亨。',
            '坤': '地势坤，君子以厚德载物。利牝马之贞。',
            '震': '震惊百里，不丧匕鬯。亨，震来虩虩。',
            '巽': '随风巽，君子以申命行事。小亨，利有攸往。',
            '坎': '水流而不盈，行险而不失其信。习坎，有孚。',
            '离': '明两作离，大人以继明照于四方。利贞，亨。',
            '艮': '时止则止，时行则行。艮其背，不获其身。',
            '兑': '丽泽兑，君子以朋友讲习。亨，利贞。'
        };
        
        const yiItems = ['祭祀', '祈福', '求嗣', '开光', '出行', '解除', '纳采', '冠笄', '嫁娶', '纳婿',
                        '安床', '移徙', '入宅', '安香', '拆卸', '动土', '挂匾', '开市', '立券', '纳财'];
        
        const jiItems = ['嫁娶', '安葬', '出行', '动土', '开市', '入宅', '移徙', '祭祀', '祈福', '开光'];
        
        const quotes = [
            { text: '积善之家，必有余庆；积不善之家，必有余殃。', source: '《易经·坤卦》' },
            { text: '天行健，君子以自强不息。', source: '《易经·乾卦》' },
            { text: '地势坤，君子以厚德载物。', source: '《易经·坤卦》' },
            { text: '穷则变，变则通，通则久。', source: '《易经·系辞》' },
            { text: '君子藏器于身，待时而动。', source: '《易经·系辞》' },
            { text: '二人同心，其利断金。', source: '《易经·系辞》' },
            { text: '谦谦君子，用涉大川。', source: '《易经·谦卦》' },
            { text: '居上位而不骄，在下位而不忧。', source: '《易经·乾卦》' }
        ];
        
        const solarTerms = ['小寒', '大寒', '立春', '雨水', '惊蛰', '春分', '清明', '谷雨', 
                           '立夏', '小满', '芒种', '夏至', '小暑', '大暑', '立秋', '处暑',
                           '白露', '秋分', '寒露', '霜降', '立冬', '小雪', '大雪', '冬至'];
        
        const zodiacFortune = {
            '鼠': { overall: '运势平稳，贵人相助', career: '工作顺利，有升职机会', wealth: '财运尚可，稳健为主', love: '感情稳定', health: '注意休息' },
            '牛': { overall: '稳中有进，厚积薄发', career: '脚踏实地，终有回报', wealth: '正财为主', love: '真诚待人', health: '肠胃需注意' },
            '虎': { overall: '冲劲十足，把握机会', career: '事业上升期', wealth: '财运旺盛', love: '桃花旺盛', health: '注意肝胆' },
            '兔': { overall: '温和顺利，人缘极佳', career: '贵人运强', wealth: '收入稳定', love: '感情甜蜜', health: '情绪稳定' },
            '龙': { overall: '本命年需谨慎', career: '事业有阻', wealth: '财运起伏', love: '感情需经营', health: '注意安全' },
            '蛇': { overall: '运势上升，把握机遇', career: '智慧取胜', wealth: '偏财运佳', love: '魅力提升', health: '注意皮肤' },
            '马': { overall: '奔波劳碌，收获颇丰', career: '事业忙碌', wealth: '多劳多得', love: '异地有情', health: '注意心脏' },
            '羊': { overall: '温和吉祥，诸事顺遂', career: '稳步发展', wealth: '财运平稳', love: '感情细腻', health: '注意保暖' },
            '猴': { overall: '灵活应变，机遇多多', career: '创意无限', wealth: '财路宽广', love: '桃花运旺', health: '注意呼吸系统' },
            '鸡': { overall: '金鸡报晓，好运将至', career: '努力有回报', wealth: '正财为主', love: '感情专一', health: '注意咽喉' },
            '狗': { overall: '忠诚守信，贵人相助', career: '事业稳定', wealth: '财运平稳', love: '感情忠诚', health: '注意关节' },
            '猪': { overall: '福气满满，诸事吉祥', career: '工作顺利', wealth: '财运亨通', love: '感情甜蜜', health: '注意体重' }
        };
        
        const wuxingData = {
            '金': { color: 'gray', nature: '收敛', direction: '西', season: '秋', organs: '肺、大肠' },
            '木': { color: 'green', nature: '生发', direction: '东', season: '春', organs: '肝、胆' },
            '水': { color: 'blue', nature: '润下', direction: '北', season: '冬', organs: '肾、膀胱' },
            '火': { color: 'red', nature: '炎上', direction: '南', season: '夏', organs: '心、小肠' },
            '土': { color: 'yellow', nature: '承载', direction: '中', season: '长夏', organs: '脾、胃' }
        };
        
        const lunarInfo = [
            0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,
            0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,
            0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,
            0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,
            0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,
            0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,
            0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,
            0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,
            0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,
            0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,
            0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,
            0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,
            0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,
            0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,
            0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0,
            0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 0x0aae0,
            0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4,
            0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0,
            0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160,
            0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252,
            0x0d520
        ];
        
        // ==================== 工具函数 ====================
        function getLunarMonthDays(year, month) {
            return (lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;
        }
        
        function getLunarYearDays(year) {
            let sum = 348;
            for (let i = 0x8000; i > 0x8; i >>= 1) {
                sum += (lunarInfo[year - 1900] & i) ? 1 : 0;
            }
            return sum + getLeapMonthDays(year);
        }
        
        function getLeapMonth(year) { return lunarInfo[year - 1900] & 0xf; }
        
        function getLeapMonthDays(year) {
            return getLeapMonth(year) ? ((lunarInfo[year - 1900] & 0x10000) ? 30 : 29) : 0;
        }
        
        function solarToLunar(year, month, day) {
            const baseDate = new Date(1900, 0, 31);
            const targetDate = new Date(year, month - 1, day);
            let offset = Math.floor((targetDate - baseDate) / 86400000);
            
            let lunarYear = 1900, lunarMonth = 1, lunarDay = 1, isLeap = false;
            
            while (lunarYear < 2100 && offset > 0) {
                const yearDays = getLunarYearDays(lunarYear);
                if (offset < yearDays) break;
                offset -= yearDays;
                lunarYear++;
            }
            
            const leapMonth = getLeapMonth(lunarYear);
            
            for (let i = 1; i <= 12; i++) {
                let monthDays;
                if (leapMonth > 0 && i === leapMonth + 1 && !isLeap) {
                    monthDays = getLeapMonthDays(lunarYear);
                    isLeap = true;
                    i--;
                } else {
                    monthDays = getLunarMonthDays(lunarYear, i);
                    isLeap = false;
                }
                if (offset < monthDays) { lunarMonth = i; break; }
                offset -= monthDays;
            }
            
            lunarDay = offset + 1;
            return { year: lunarYear, month: lunarMonth, day: lunarDay, isLeap: isLeap };
        }
        
        function getGanZhiYear(year) { return tianGan[(year - 4) % 10] + diZhi[(year - 4) % 12]; }
        function getZodiac(year) { return shengXiao[(year - 4) % 12]; }
        
        function generateYiJi(seed) {
            const random = (s) => Math.sin(s) * 10000 - Math.floor(Math.sin(s) * 10000);
            const yiCount = Math.floor(random(seed) * 5) + 4;
            const jiCount = Math.floor(random(seed + 1) * 4) + 2;
            return {
                yi: [...yiItems].sort(() => random(seed + 2) - 0.5).slice(0, yiCount),
                ji: [...jiItems].sort(() => random(seed + 3) - 0.5).slice(0, jiCount)
            };
        }
        
        function getTodayGua(date) {
            const seed = date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate();
            return bagua[Math.abs(Math.floor((Math.sin(seed) * 10000) % 8))];
        }
        
        // ==================== 动态效果 ====================
        function createParticles(containerId, count = 100) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'star absolute rounded-full';
                
                const size = Math.random() * 4 + 1;
                const hue = Math.random() > 0.7 ? '45' : '0'; // 金色或白色
                
                particle.style.cssText = `
                    width: ${size}px;
                    height: ${size}px;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    background: hsl(${hue}, ${hue === '45' ? '70%' : '0%'}, ${hue === '45' ? '60%' : '90%'});
                    animation-delay: ${Math.random() * 3}s;
                    animation-duration: ${Math.random() * 3 + 2}s;
                `;
                container.appendChild(particle);
            }
        }
        
        function createClouds(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'absolute float-cloud';
                cloud.style.cssText = `
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    width: ${Math.random() * 200 + 100}px;
                    height: ${Math.random() * 100 + 50}px;
                    background: radial-gradient(ellipse, rgba(212,175,55,0.1), transparent);
                    filter: blur(20px);
                    animation-delay: ${Math.random() * 5}s;
                `;
                container.appendChild(cloud);
            }
        }
        
        // ==================== 入口逻辑 ====================
        function enterApp() {
            const chaos = document.getElementById('chaosEntry');
            const main = document.getElementById('mainApp');
            
            // 天地分离动画
            document.getElementById('skyLayer').style.animation = 'skyEarthSplit 1.5s ease-out forwards';
            document.getElementById('earthLayer').style.animation = 'skyEarthSplit 1.5s ease-out forwards';
            
            setTimeout(() => {
                chaos.style.transition = 'opacity 1s';
                chaos.style.opacity = '0';
                
                setTimeout(() => {
                    chaos.classList.add('hidden');
                    main.classList.remove('hidden');
                    main.style.animation = 'fadeIn 1s ease-out';
                    
                    createParticles('bgStars', 150);
                    createClouds('bgClouds');
                    updateMainInfo();
                    switchTab('overview');
                }, 500);
            }, 1000);
        }
        
        function updateMainInfo() {
            const today = new Date();
            const lunar = solarToLunar(today.getFullYear(), today.getMonth() + 1, today.getDate());
            const yiji = generateYiJi(today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate());
            const gua = getTodayGua(today);
            
            document.getElementById('headerDate').textContent = `${today.getFullYear()}年${today.getMonth() + 1}月${today.getDate()}日`;
            document.getElementById('headerLunar').textContent = `农历${getGanZhiYear(lunar.year)}年 ${lunarMonths[lunar.month - 1]}月${lunarDays[lunar.day - 1]}`;
            
            document.getElementById('todaySolar').textContent = `${today.getMonth() + 1}月${today.getDate()}日`;
            document.getElementById('todayLunar').textContent = `${getGanZhiYear(lunar.year)}年 ${lunarMonths[lunar.month - 1]}月${lunarDays[lunar.day - 1]}`;
            
            document.getElementById('todayGua').textContent = gua;
            document.getElementById('todayGuaName').textContent = baguaName[gua];
            
            document.getElementById('quickYi').textContent = yiji.yi.slice(0, 2).join(' ');
            document.getElementById('quickJi').textContent = yiji.ji.slice(0, 2).join(' ');
            
            const quoteIndex = (today.getDate()) % quotes.length;
            document.getElementById('dailyQuote').textContent = `"${quotes[quoteIndex].text}"`;
        }
        
        // ==================== 标签页切换 ====================
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'text-gold', 'border-gold');
                btn.classList.add('text-parchment/70', 'border-transparent');
            });
            
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active', 'text-gold', 'border-gold');
                activeBtn.classList.remove('text-parchment/70', 'border-transparent');
            }
            
            const content = document.getElementById('tabContent');
            content.style.animation = 'fadeIn 0.3s ease-out';
            
            switch(tabName) {
                case 'overview': loadOverviewTab(content); break;
                case 'wuxing': loadWuxingTab(content); break;
                case 'zodiac': loadZodiacTab(content); break;
                case 'blessing': loadBlessingTab(content); break;
            }
        }
        
        function loadOverviewTab(container) {
            const today = new Date();
            const yiji = generateYiJi(today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate());
            const gua = getTodayGua(today);
            
            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-5 rounded-2xl bg-jade/10 border border-jade/30">
                        <div class="flex items-center mb-4">
                            <span class="w-10 h-10 rounded-full bg-jade/20 flex items-center justify-center text-jade text-xl mr-3">宜</span>
                            <span class="text-jade text-xl ancient-font">今日宜事</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            ${yiji.yi.map(y => `<span class="px-3 py-1 rounded-lg bg-jade/20 text-jade/90 text-sm">${y}</span>`).join('')}
                        </div>
                    </div>
                    <div class="p-5 rounded-2xl bg-cinnabar/10 border border-cinnabar/30">
                        <div class="flex items-center mb-4">
                            <span class="w-10 h-10 rounded-full bg-cinnabar/20 flex items-center justify-center text-cinnabar text-xl mr-3">忌</span>
                            <span class="text-cinnabar text-xl ancient-font">今日忌事</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            ${yiji.ji.map(j => `<span class="px-3 py-1 rounded-lg bg-cinnabar/20 text-cinnabar/90 text-sm">${j}</span>`).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 p-5 rounded-2xl bg-gradient-to-br from-gold/10 to-bronze/10 border border-gold/30">
                    <div class="text-center">
                        <div class="text-bronze text-sm mb-2">今日卦辞</div>
                        <div class="text-parchment/80 text-lg italic leading-relaxed">"${guaCi[gua]}"</div>
                    </div>
                </div>
                
                <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-jade text-sm">喜神方位</div>
                        <div class="text-gold text-lg mt-1">东南</div>
                    </div>
                    <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-jade text-sm">财神方位</div>
                        <div class="text-gold text-lg mt-1">正南</div>
                    </div>
                    <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-bronze text-sm">吉时</div>
                        <div class="text-gold text-lg mt-1">子、卯、午</div>
                    </div>
                    <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-cinnabar text-sm">冲煞</div>
                        <div class="text-parchment/70 text-lg mt-1">冲龙煞北</div>
                    </div>
                </div>
            `;
        }
        
        function loadWuxingTab(container) {
            const today = new Date();
            const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
            
            const elements = [
                { name: '金', color: 'gray', bg: 'bg-gray-700/30', text: 'text-gray-300', fill: 'bg-gray-400' },
                { name: '木', color: 'green', bg: 'bg-green-900/30', text: 'text-green-400', fill: 'bg-green-500' },
                { name: '水', color: 'blue', bg: 'bg-blue-900/30', text: 'text-blue-400', fill: 'bg-blue-500' },
                { name: '火', color: 'red', bg: 'bg-red-900/30', text: 'text-red-400', fill: 'bg-red-500' },
                { name: '土', color: 'yellow', bg: 'bg-yellow-900/30', text: 'text-yellow-400', fill: 'bg-yellow-500' }
            ];
            
            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <h4 class="text-gold text-lg ancient-font">今日五行能量</h4>
                        ${elements.map((el, i) => {
                            const val = Math.floor((Math.sin(seed + i) * 10000) % 50) + 50;
                            return `
                                <div class="p-4 rounded-xl ${el.bg} border border-${el.color}-500/30">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="${el.text} text-xl ancient-font">${el.name}</span>
                                        <span class="${el.text}">${val}%</span>
                                    </div>
                                    <div class="w-full h-3 bg-obsidian/50 rounded-full overflow-hidden">
                                        <div class="h-full ${el.fill} rounded-full transition-all duration-1000" style="width: ${val}%"></div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="space-y-4">
                        <h4 class="text-gold text-lg ancient-font">五行相生相克</h4>
                        <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20">
                            <div class="text-jade mb-2">相生之道</div>
                            <div class="text-parchment/70">木生火 → 火生土 → 土生金 → 金生水 → 水生木</div>
                        </div>
                        <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20">
                            <div class="text-cinnabar mb-2">相克之道</div>
                            <div class="text-parchment/70">木克土 → 土克水 → 水克火 → 火克金 → 金克木</div>
                        </div>
                        
                        <div class="p-4 rounded-xl bg-gradient-to-br from-jade/10 to-gold/10 border border-jade/30">
                            <div class="text-gold mb-2">今日建议</div>
                            <div class="text-parchment/70 text-sm leading-relaxed">
                                今日五行能量以${elements[Math.floor(Math.sin(seed) * 10000) % 5].name}为主，宜穿戴${elements[Math.floor(Math.sin(seed) * 10000) % 5].color === 'red' ? '红色' : elements[Math.floor(Math.sin(seed) * 10000) % 5].color === 'green' ? '绿色' : '相关颜色'}服饰，有助于增强运势。
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function loadZodiacTab(container) {
            container.innerHTML = `
                <div class="grid grid-cols-3 md:grid-cols-6 gap-3 mb-6">
                    ${shengXiao.map((z, i) => `
                        <button onclick="showZodiacInfo('${z}')" class="p-3 rounded-xl bg-gold/5 border border-gold/20 hover:border-gold/50 text-center transition-all hover:bg-gold/10">
                            <div class="text-2xl mb-1">${['🐭', '🐮', '🐯', '🐰', '🐲', '🐍', '🐴', '🐏', '🐵', '🐔', '🐶', '🐷'][i]}</div>
                            <div class="text-gold text-sm">${z}</div>
                        </button>
                    `).join('')}
                </div>
                <div id="zodiacInfoPanel" class="p-5 rounded-2xl bg-obsidian/50 border border-gold/20">
                    <div class="text-center text-parchment/50">点击上方生肖查看详情</div>
                </div>
            `;
        }
        
        function showZodiacInfo(zodiac) {
            const fortune = zodiacFortune[zodiac];
            document.getElementById('zodiacInfoPanel').innerHTML = `
                <h4 class="text-gold text-xl ancient-font text-center mb-4">${zodiac}年运势</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-3">
                        <div class="p-3 rounded-lg bg-gold/5"><span class="text-bronze">整体运势：</span><span class="text-parchment">${fortune.overall}</span></div>
                        <div class="p-3 rounded-lg bg-gold/5"><span class="text-bronze">事业运势：</span><span class="text-parchment">${fortune.career}</span></div>
                    </div>
                    <div class="space-y-3">
                        <div class="p-3 rounded-lg bg-gold/5"><span class="text-bronze">财运运势：</span><span class="text-parchment">${fortune.wealth}</span></div>
                        <div class="p-3 rounded-lg bg-gold/5"><span class="text-bronze">健康运势：</span><span class="text-parchment">${fortune.health}</span></div>
                    </div>
                </div>
            `;
        }
        
        function loadBlessingTab(container) {
            container.innerHTML = `
                <div class="text-center">
                    <div class="relative w-40 h-40 mx-auto mb-6">
                        <svg viewBox="0 0 100 100" class="w-full h-full breathe">
                            <ellipse cx="50" cy="70" rx="30" ry="10" fill="rgba(0,168,107,0.2)"/>
                            <path d="M50 30 Q30 50 50 70 Q70 50 50 30" fill="rgba(212,175,55,0.6)"/>
                            <path d="M50 35 Q35 50 50 65 Q65 50 50 35" fill="rgba(212,175,55,0.8)"/>
                            <circle cx="50" cy="50" r="5" fill="#C41E3A"/>
                        </svg>
                    </div>
                    <button onclick="lightLamp()" class="px-8 py-4 rounded-xl bg-gradient-to-r from-cinnabar/40 to-gold/40 border border-gold/50 text-gold text-xl hover:from-cinnabar/50 hover:to-gold/50 transition-all">
                        <i class="fas fa-fire mr-2"></i>点燃心灯
                    </button>
                    <div id="blessingMsg" class="mt-6 text-parchment/70"></div>
                </div>
            `;
        }
        
        function lightLamp() {
            const count = Math.floor(Math.random() * 10000) + 100000;
            document.getElementById('blessingMsg').innerHTML = `
                <div class="text-jade text-xl mb-2">祈福成功</div>
                <p>愿您心想事成，万事如意！</p>
                <p class="text-gold/50 text-sm mt-2">已为您点亮第 ${count.toLocaleString()} 盏心灯</p>
            `;
        }
        
        // ==================== 模态框系统 ====================
        function openModule(moduleName) {
            const overlay = document.getElementById('modalOverlay');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            
            overlay.classList.remove('hidden');
            body.scrollTop = 0;
            
            const modules = {
                'tianshi': { title: '天时 · 历法卦象', loader: loadTianshiModule },
                'dili': { title: '地利 · 风水方位', loader: loadDiliModule },
                'renhe': { title: '人和 · 命理运势', loader: loadRenheModule },
                'xuanji': { title: '玄机 · 占卜解梦', loader: loadXuanjiModule },
                'history': { title: '历史今日', loader: loadHistoryModule },
                'festival': { title: '节日节气', loader: loadFestivalModule },
                'health': { title: '养生之道', loader: loadHealthModule },
                'culture': { title: '国学经典', loader: loadCultureModule }
            };
            
            const mod = modules[moduleName];
            if (mod) {
                title.textContent = mod.title;
                mod.loader(body);
            }
        }
        
        function closeModal() {
            document.getElementById('modalOverlay').classList.add('hidden');
        }
        
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // ==================== 模块加载器 ====================
        function loadTianshiModule(body) {
            body.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <button onclick="loadSubModule('calendar')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-calendar-alt text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">万年历</div>
                        <div class="text-parchment/50 text-xs">农历公历对照</div>
                    </button>
                    <button onclick="loadSubModule('fortune')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-star text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">每日运势</div>
                        <div class="text-parchment/50 text-xs">今日吉凶宜忌</div>
                    </button>
                    <button onclick="loadSubModule('luckyday')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-calendar-check text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">择吉日</div>
                        <div class="text-parchment/50 text-xs">挑选良辰吉日</div>
                    </button>
                </div>
                <div id="subModuleContent" class="mt-6"></div>
            `;
        }
        
        function loadDiliModule(body) {
            body.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <button onclick="loadSubModule('fengshui')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-compass text-3xl text-jade mb-2"></i>
                        <div class="text-gold ancient-font text-lg">风水罗盘</div>
                        <div class="text-parchment/50 text-xs">方位吉凶指南</div>
                    </button>
                    <button onclick="loadSubModule('direction')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-location-arrow text-3xl text-jade mb-2"></i>
                        <div class="text-gold ancient-font text-lg">吉神方位</div>
                        <div class="text-parchment/50 text-xs">财神喜神方位</div>
                    </button>
                    <button onclick="loadSubModule('travel')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-route text-3xl text-jade mb-2"></i>
                        <div class="text-gold ancient-font text-lg">出行指南</div>
                        <div class="text-parchment/50 text-xs">今日出行宜忌</div>
                    </button>
                </div>
                <div id="subModuleContent" class="mt-6"></div>
            `;
        }
        
        function loadRenheModule(body) {
            body.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <button onclick="loadSubModule('bazi')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-yin-yang text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">八字算命</div>
                        <div class="text-parchment/50 text-xs">生辰八字推算</div>
                    </button>
                    <button onclick="loadSubModule('name')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-signature text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">姓名测算</div>
                        <div class="text-parchment/50 text-xs">姓名吉凶分析</div>
                    </button>
                    <button onclick="loadSubModule('match')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-heart text-3xl text-cinnabar mb-2"></i>
                        <div class="text-gold ancient-font text-lg">姻缘配对</div>
                        <div class="text-parchment/50 text-xs">八字合婚测算</div>
                    </button>
                </div>
                <div id="subModuleContent" class="mt-6"></div>
            `;
        }
        
        function loadXuanjiModule(body) {
            body.innerHTML = `
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <button onclick="loadSubModule('dream')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-moon text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">解梦占卜</div>
                        <div class="text-parchment/50 text-xs">周公解梦查询</div>
                    </button>
                    <button onclick="loadSubModule('divination')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-dice text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">六爻占卜</div>
                        <div class="text-parchment/50 text-xs">易经占卜预测</div>
                    </button>
                    <button onclick="loadSubModule('tarot')" class="jade-pendant p-6 text-center hover:scale-105 transition-transform">
                        <i class="fas fa-cards text-3xl text-gold mb-2"></i>
                        <div class="text-gold ancient-font text-lg">塔罗占卜</div>
                        <div class="text-parchment/50 text-xs">西方神秘占卜</div>
                    </button>
                </div>
                <div id="subModuleContent" class="mt-6"></div>
            `;
        }
        
        function loadHistoryModule(body) {
            const events = [
                { year: '公元前221年', event: '秦始皇统一六国' },
                { year: '公元105年', event: '蔡伦改进造纸术' },
                { year: '公元1405年', event: '郑和首次下西洋' },
                { year: '公元1662年', event: '郑成功收复台湾' },
                { year: '公元1949年', event: '中华人民共和国成立' }
            ];
            
            body.innerHTML = `
                <div class="space-y-4">
                    ${events.map(e => `
                        <div class="flex items-start p-4 rounded-xl bg-gold/5 border border-gold/10 hover:border-gold/30 transition-all">
                            <div class="w-28 text-bronze text-sm flex-shrink-0">${e.year}</div>
                            <div class="text-parchment/80">${e.event}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        function loadFestivalModule(body) {
            body.innerHTML = `
                <div class="grid grid-cols-3 md:grid-cols-6 gap-3 mb-6">
                    ${solarTerms.map(t => `
                        <div class="p-3 rounded-xl bg-gold/5 border border-gold/20 text-center">
                            <span class="text-gold text-sm">${t}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        function loadHealthModule(body) {
            const today = new Date();
            const season = today.getMonth() >= 2 && today.getMonth() <= 4 ? '春' : 
                          today.getMonth() >= 5 && today.getMonth() <= 7 ? '夏' :
                          today.getMonth() >= 8 && today.getMonth() <= 10 ? '秋' : '冬';
            
            const healthTips = {
                '春': { organ: '肝', food: '绿色蔬菜、豆芽', exercise: '晨起散步、太极拳', avoid: '过度劳累、情绪激动' },
                '夏': { organ: '心', food: '苦瓜、绿豆汤', exercise: '游泳、慢跑', avoid: '暴晒、贪凉' },
                '秋': { organ: '肺', food: '梨、百合、银耳', exercise: '登山、深呼吸', avoid: '辛辣、熬夜' },
                '冬': { organ: '肾', food: '黑芝麻、核桃', exercise: '室内运动、泡脚', avoid: '受寒、过度出汗' }
            };
            
            const tips = healthTips[season];
            
            body.innerHTML = `
                <div class="text-center mb-6">
                    <div class="text-gold text-2xl ancient-font">${season}季养生</div>
                    <div class="text-parchment/50 text-sm">顺应四时，天人合一</div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-5 rounded-xl bg-jade/10 border border-jade/30">
                        <div class="text-jade mb-2">重点养护</div>
                        <div class="text-parchment">${tips.organ}脏</div>
                    </div>
                    <div class="p-5 rounded-xl bg-gold/10 border border-gold/30">
                        <div class="text-gold mb-2">推荐食物</div>
                        <div class="text-parchment">${tips.food}</div>
                    </div>
                    <div class="p-5 rounded-xl bg-azure/10 border border-azure/30">
                        <div class="text-azure mb-2">适宜运动</div>
                        <div class="text-parchment">${tips.exercise}</div>
                    </div>
                    <div class="p-5 rounded-xl bg-cinnabar/10 border border-cinnabar/30">
                        <div class="text-cinnabar mb-2">注意事项</div>
                        <div class="text-parchment">${tips.avoid}</div>
                    </div>
                </div>
            `;
        }
        
        function loadCultureModule(body) {
            const classics = [
                { name: '《易经》', desc: '群经之首，大道之源' },
                { name: '《道德经》', desc: '道可道，非常道' },
                { name: '《论语》', desc: '半部论语治天下' },
                { name: '《黄帝内经》', desc: '医家之宗，养生宝典' }
            ];
            
            body.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    ${classics.map(c => `
                        <div class="p-5 rounded-xl bg-gold/5 border border-gold/20 hover:border-gold/40 transition-all">
                            <div class="text-gold text-lg ancient-font mb-2">${c.name}</div>
                            <div class="text-parchment/70 text-sm">${c.desc}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // 子模块加载
        function loadSubModule(name) {
            const container = document.getElementById('subModuleContent');
            if (!container) return;
            
            container.innerHTML = '<div class="text-center text-gold/50 py-8"><i class="fas fa-spinner fa-spin text-2xl"></i></div>';
            
            setTimeout(() => {
                switch(name) {
                    case 'calendar': loadCalendarContent(container); break;
                    case 'fortune': loadFortuneContent(container); break;
                    case 'bazi': loadBaziContent(container); break;
                    case 'name': loadNameContent(container); break;
                    case 'dream': loadDreamContent(container); break;
                    case 'fengshui': loadFengshuiContent(container); break;
                    default: container.innerHTML = '<div class="text-center text-parchment/50 py-8">功能开发中...</div>';
                }
            }, 300);
        }
        
        function loadCalendarContent(container) {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const totalDays = new Date(year, month + 1, 0).getDate();
            
            let html = `
                <div class="p-4 rounded-xl bg-obsidian/50 border border-gold/20">
                    <div class="text-center mb-4">
                        <div class="ancient-font text-2xl text-gold">${getGanZhiYear(year)}年</div>
                        <div class="text-bronze">${year}年${month + 1}月</div>
                    </div>
                    <div class="grid grid-cols-7 gap-1 text-center text-sm mb-2">
                        <div class="text-cinnabar">日</div>
                        <div class="text-gold/70">一</div>
                        <div class="text-gold/70">二</div>
                        <div class="text-gold/70">三</div>
                        <div class="text-gold/70">四</div>
                        <div class="text-gold/70">五</div>
                        <div class="text-cinnabar">六</div>
                    </div>
                    <div class="grid grid-cols-7 gap-1">
            `;
            
            for (let i = 0; i < firstDay; i++) html += '<div class="aspect-square"></div>';
            
            for (let day = 1; day <= totalDays; day++) {
                const isToday = day === today.getDate();
                const lunar = solarToLunar(year, month + 1, day);
                html += `
                    <div class="aspect-square rounded-lg p-1 flex flex-col items-center justify-center cursor-pointer
                        ${isToday ? 'bg-cinnabar/30 border border-cinnabar' : 'bg-obsidian/30 hover:bg-gold/10'}">
                        <span class="text-xs ${isToday ? 'text-gold' : 'text-parchment'}">${day}</span>
                        <span class="text-xs text-gold/50">${lunarDays[lunar.day - 1]}</span>
                    </div>
                `;
            }
            
            html += '</div></div>';
            container.innerHTML = html;
        }
        
        function loadFortuneContent(container) {
            const today = new Date();
            const yiji = generateYiJi(today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate());
            
            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-5 rounded-xl bg-jade/10 border border-jade/30">
                        <div class="text-jade text-lg mb-3">宜</div>
                        <div class="flex flex-wrap gap-2">
                            ${yiji.yi.map(y => `<span class="px-3 py-1 rounded-lg bg-jade/20 text-jade/90 text-sm">${y}</span>`).join('')}
                        </div>
                    </div>
                    <div class="p-5 rounded-xl bg-cinnabar/10 border border-cinnabar/30">
                        <div class="text-cinnabar text-lg mb-3">忌</div>
                        <div class="flex flex-wrap gap-2">
                            ${yiji.ji.map(j => `<span class="px-3 py-1 rounded-lg bg-cinnabar/20 text-cinnabar/90 text-sm">${j}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        
        function loadBaziContent(container) {
            container.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-parchment/70 text-sm block mb-2">出生日期</label>
                            <input type="date" id="baziDate" class="w-full bg-obsidian/50 border border-gold/30 rounded-xl px-4 py-3 text-parchment focus:border-gold focus:outline-none">
                        </div>
                        <div>
                            <label class="text-parchment/70 text-sm block mb-2">出生时辰</label>
                            <select id="baziHour" class="w-full bg-obsidian/50 border border-gold/30 rounded-xl px-4 py-3 text-parchment focus:border-gold focus:outline-none">
                                ${diZhi.map((z, i) => `<option value="${i}">${z}时</option>`).join('')}
                            </select>
                        </div>
                    </div>
                    <button onclick="calcBazi()" class="w-full py-3 rounded-xl bg-gradient-to-r from-gold/30 to-bronze/30 border border-gold/50 text-gold hover:from-gold/40 hover:to-bronze/40 transition-all">
                        开始推算
                    </button>
                    <div id="baziResult"></div>
                </div>
            `;
        }
        
        function calcBazi() {
            const dateVal = document.getElementById('baziDate').value;
            const hourVal = parseInt(document.getElementById('baziHour').value);
            
            if (!dateVal) { alert('请选择日期'); return; }
            
            const date = new Date(dateVal);
            const lunar = solarToLunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
            
            const yearGan = tianGan[(lunar.year - 4) % 10];
            const yearZhi = diZhi[(lunar.year - 4) % 12];
            const monthGan = tianGan[(lunar.year * 12 + lunar.month + 2) % 10];
            const monthZhi = diZhi[(lunar.month + 1) % 12];
            const dayGan = tianGan[(date.getDate() + 5) % 10];
            const dayZhi = diZhi[(date.getDate() + 5) % 12];
            const hourGan = tianGan[(date.getDate() * 2 + hourVal) % 10];
            const hourZhi = diZhi[hourVal];
            
            document.getElementById('baziResult').innerHTML = `
                <div class="grid grid-cols-4 gap-3 mt-4">
                    <div class="p-4 rounded-xl bg-gold/10 border border-gold/30 text-center">
                        <div class="text-bronze text-xs">年柱</div>
                        <div class="ancient-font text-2xl text-gold">${yearGan}${yearZhi}</div>
                    </div>
                    <div class="p-4 rounded-xl bg-gold/10 border border-gold/30 text-center">
                        <div class="text-bronze text-xs">月柱</div>
                        <div class="ancient-font text-2xl text-gold">${monthGan}${monthZhi}</div>
                    </div>
                    <div class="p-4 rounded-xl bg-gold/10 border border-gold/30 text-center">
                        <div class="text-bronze text-xs">日柱</div>
                        <div class="ancient-font text-2xl text-gold">${dayGan}${dayZhi}</div>
                    </div>
                    <div class="p-4 rounded-xl bg-gold/10 border border-gold/30 text-center">
                        <div class="text-bronze text-xs">时柱</div>
                        <div class="ancient-font text-2xl text-gold">${hourGan}${hourZhi}</div>
                    </div>
                </div>
            `;
        }
        
        function loadNameContent(container) {
            container.innerHTML = `
                <div class="space-y-4">
                    <input type="text" id="nameInput" placeholder="请输入姓名" maxlength="4"
                        class="w-full bg-obsidian/50 border border-gold/30 rounded-xl px-4 py-4 text-parchment text-center text-xl focus:border-gold focus:outline-none">
                    <button onclick="calcName()" class="w-full py-3 rounded-xl bg-gradient-to-r from-gold/30 to-bronze/30 border border-gold/50 text-gold hover:from-gold/40 hover:to-bronze/40 transition-all">
                        开始测算
                    </button>
                    <div id="nameResult"></div>
                </div>
            `;
        }
        
        function calcName() {
            const name = document.getElementById('nameInput').value.trim();
            if (name.length < 2) { alert('请输入至少2个字'); return; }
            
            const score = Math.floor(Math.random() * 20) + 80;
            document.getElementById('nameResult').innerHTML = `
                <div class="text-center p-5 rounded-xl bg-gold/10 border border-gold/30 mt-4">
                    <div class="text-gold text-lg mb-2">姓名评分</div>
                    <div class="ancient-font text-5xl text-gold text-glow">${score}</div>
                    <div class="text-bronze mt-2">${score >= 90 ? '上上签' : score >= 80 ? '上签' : '中签'}</div>
                </div>
            `;
        }
        
        function loadDreamContent(container) {
            container.innerHTML = `
                <div class="space-y-4">
                    <input type="text" id="dreamInput" placeholder="请输入梦境关键词"
                        class="w-full bg-obsidian/50 border border-gold/30 rounded-xl px-4 py-4 text-parchment text-center text-xl focus:border-gold focus:outline-none">
                    <button onclick="interpDream()" class="w-full py-3 rounded-xl bg-gradient-to-r from-gold/30 to-bronze/30 border border-gold/50 text-gold hover:from-gold/40 hover:to-bronze/40 transition-all">
                        解梦
                    </button>
                    <div id="dreamResult"></div>
                </div>
            `;
        }
        
        function interpDream() {
            const keyword = document.getElementById('dreamInput').value.trim();
            if (!keyword) { alert('请输入关键词'); return; }
            
            const meanings = ['此梦主吉，预示好运将至', '此梦警示，需谨慎行事', '此梦平平，顺其自然', '此梦吉祥，心想事成'];
            document.getElementById('dreamResult').innerHTML = `
                <div class="p-5 rounded-xl bg-obsidian/50 border border-gold/20 mt-4">
                    <div class="text-gold text-center">${keyword}：${meanings[Math.floor(Math.random() * meanings.length)]}</div>
                </div>
            `;
        }
        
        function loadFengshuiContent(container) {
            container.innerHTML = `
                <div class="flex justify-center mb-6">
                    <div class="relative w-64 h-64">
                        <div class="absolute inset-0 rounded-full border-2 border-gold/30 bagua-rotate">
                            <svg viewBox="0 0 200 200" class="w-full h-full">
                                <text x="100" y="15" text-anchor="middle" fill="#D4AF37" font-size="14">南</text>
                                <text x="190" y="105" text-anchor="middle" fill="#D4AF37" font-size="14">西</text>
                                <text x="100" y="195" text-anchor="middle" fill="#D4AF37" font-size="14">北</text>
                                <text x="10" y="105" text-anchor="middle" fill="#D4AF37" font-size="14">东</text>
                            </svg>
                        </div>
                        <div class="absolute inset-12 rounded-full border border-gold/20 flex items-center justify-center">
                            <div class="text-center">
                                <div class="text-xs text-bronze">今日吉方</div>
                                <div class="ancient-font text-2xl text-gold">东南</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-4 rounded-xl bg-jade/10 border border-jade/30 text-center">
                        <div class="text-jade text-sm">财神方位</div>
                        <div class="text-gold text-lg">正南</div>
                    </div>
                    <div class="p-4 rounded-xl bg-jade/10 border border-jade/30 text-center">
                        <div class="text-jade text-sm">喜神方位</div>
                        <div class="text-gold text-lg">东南</div>
                    </div>
                </div>
            `;
        }
        
        // ==================== 初始化 ====================
        document.addEventListener('DOMContentLoaded', function() {
            createParticles('chaosParticles', 150);
        });
    </script>
</body>
</html>
