<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玄机黄历 · 通天晓地</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cinnabar: '#C41E3A',
                        gold: '#D4AF37',
                        ink: '#1A1A1A',
                        bronze: '#CD7F32',
                        jade: '#00A86B',
                        vermilion: '#E34234',
                        obsidian: '#0B0B0B',
                        parchment: '#F5E6D3',
                        silk: '#FFFDD0',
                    },
                    fontFamily: {
                        ancient: ['Ma Shan Zheng', 'cursive'],
                        seal: ['ZCOOL XiaoWei', 'serif'],
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'ZCOOL XiaoWei', serif;
            background: radial-gradient(ellipse at center, #1a0a0a 0%, #0a0505 100%);
        }
        
        .ancient-font {
            font-family: 'Ma Shan Zheng', cursive;
        }
        
        /* 八卦旋转动画 */
        @keyframes rotateBagua {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes reverseRotateBagua {
            from { transform: rotate(360deg); }
            to { transform: rotate(0deg); }
        }
        
        .bagua-rotate {
            animation: rotateBagua 120s linear infinite;
        }
        
        .bagua-reverse {
            animation: reverseRotateBagua 90s linear infinite;
        }
        
        /* 光晕效果 */
        @keyframes pulse-glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(212, 175, 55, 0.3),
                            0 0 40px rgba(212, 175, 55, 0.2),
                            0 0 60px rgba(212, 175, 55, 0.1);
            }
            50% { 
                box-shadow: 0 0 30px rgba(212, 175, 55, 0.5),
                            0 0 60px rgba(212, 175, 55, 0.3),
                            0 0 90px rgba(212, 175, 55, 0.2);
            }
        }
        
        .glow-effect {
            animation: pulse-glow 4s ease-in-out infinite;
        }
        
        /* 浮动动画 */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        /* 闪烁星光 */
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .star {
            animation: twinkle 2s ease-in-out infinite;
        }
        
        /* 玻璃态效果 */
        .glass {
            background: rgba(26, 10, 10, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        /* 古卷边框 */
        .scroll-border {
            border-image: linear-gradient(135deg, #D4AF37 0%, #8B6914 50%, #D4AF37 100%) 1;
        }
        
        /* 印章效果 */
        .seal-stamp {
            position: relative;
        }
        
        .seal-stamp::after {
            content: '吉';
            position: absolute;
            top: -10px;
            right: -10px;
            width: 40px;
            height: 40px;
            background: #C41E3A;
            color: #F5E6D3;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 4px;
            transform: rotate(15deg);
            box-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        /* 日期格子悬停效果 */
        .day-cell {
            transition: all 0.3s ease;
        }
        
        .day-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1a0a0a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #D4AF37, #8B6914);
            border-radius: 4px;
        }
        
        /* 云纹装饰 */
        .cloud-pattern {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Cpath d='M30 5c-5 0-9 4-9 9 0-3-4-6-8-6-5 0-8 4-8 8 0 5 4 9 8 9h34c5 0 8-4 8-8 0-5-4-9-9-9-4 0-7 3-8 6 0-5-4-9-8-9z' fill='rgba(212,175,55,0.05)'/%3E%3C/svg%3E");
        }
        
        /* 八卦符号 */
        .trigram {
            font-size: 24px;
            color: #D4AF37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
    </style>
</head>
<body class="min-h-screen text-parchment overflow-x-hidden cloud-pattern">
    <!-- 星空背景 -->
    <div id="stars" class="fixed inset-0 pointer-events-none z-0"></div>
    
    <!-- 主容器 -->
    <div class="relative z-10 container mx-auto px-4 py-8 max-w-7xl">
        
        <!-- 顶部标题区 -->
        <header class="text-center mb-8">
            <div class="inline-block relative">
                <h1 class="ancient-font text-5xl md:text-7xl text-gold mb-2 float-animation" style="text-shadow: 0 0 30px rgba(212,175,55,0.5);">
                    玄机黄历
                </h1>
                <p class="text-bronze text-lg tracking-widest">通天晓地 · 趋吉避凶</p>
            </div>
        </header>
        
        <!-- 主内容区 -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- 左侧八卦区 -->
            <aside class="lg:col-span-3">
                <div class="glass rounded-2xl p-6 glow-effect">
                    <!-- 八卦图 -->
                    <div class="relative w-full aspect-square max-w-[280px] mx-auto mb-6">
                        <!-- 外圈 -->
                        <div class="absolute inset-0 rounded-full border-2 border-gold/30 bagua-rotate">
                            <svg viewBox="0 0 200 200" class="w-full h-full">
                                <circle cx="100" cy="100" r="98" fill="none" stroke="url(#goldGradient)" stroke-width="1"/>
                                <!-- 八卦符号 -->
                                <text x="100" y="12" text-anchor="middle" class="trigram" fill="#D4AF37">☰</text>
                                <text x="170" y="45" text-anchor="middle" class="trigram" fill="#D4AF37">☱</text>
                                <text x="190" y="105" text-anchor="middle" class="trigram" fill="#D4AF37">☲</text>
                                <text x="170" y="165" text-anchor="middle" class="trigram" fill="#D4AF37">☳</text>
                                <text x="100" y="195" text-anchor="middle" class="trigram" fill="#D4AF37">☷</text>
                                <text x="30" y="165" text-anchor="middle" class="trigram" fill="#D4AF37">☶</text>
                                <text x="10" y="105" text-anchor="middle" class="trigram" fill="#D4AF37">☵</text>
                                <text x="30" y="45" text-anchor="middle" class="trigram" fill="#D4AF37">☴</text>
                                <defs>
                                    <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#D4AF37"/>
                                        <stop offset="50%" style="stop-color:#8B6914"/>
                                        <stop offset="100%" style="stop-color:#D4AF37"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                        </div>
                        
                        <!-- 中圈 -->
                        <div class="absolute inset-8 rounded-full border border-gold/20 bagua-reverse flex items-center justify-center">
                            <div class="text-center">
                                <div class="text-xs text-bronze mb-1">今日卦象</div>
                                <div id="todayGua" class="ancient-font text-4xl text-gold">乾</div>
                            </div>
                        </div>
                        
                        <!-- 太极图 -->
                        <div class="absolute inset-16 rounded-full overflow-hidden bagua-rotate" style="animation-duration: 60s;">
                            <svg viewBox="0 0 100 100" class="w-full h-full">
                                <circle cx="50" cy="50" r="50" fill="#1a0a0a"/>
                                <path d="M50 0 A50 50 0 0 1 50 100 A25 25 0 0 1 50 50 A25 25 0 0 0 50 0" fill="#D4AF37"/>
                                <circle cx="50" cy="25" r="8" fill="#1a0a0a"/>
                                <circle cx="50" cy="75" r="8" fill="#D4AF37"/>
                            </svg>
                        </div>
                    </div>
                    
                    <!-- 今日卦辞 -->
                    <div class="bg-obsidian/50 rounded-xl p-4 border border-gold/20">
                        <h3 class="text-gold text-center mb-2 ancient-font text-xl">今日卦辞</h3>
                        <p id="guaCi" class="text-parchment/80 text-sm text-center leading-relaxed">
                            天行健，君子以自强不息
                        </p>
                    </div>
                </div>
                
                <!-- 五行属性 -->
                <div class="glass rounded-2xl p-6 mt-6">
                    <h3 class="text-gold text-center mb-4 ancient-font text-xl">五行能量</h3>
                    <div class="grid grid-cols-5 gap-2">
                        <div class="text-center p-2 rounded-lg bg-green-900/30 border border-green-500/30">
                            <div class="text-2xl mb-1">木</div>
                            <div id="woodVal" class="text-xs text-green-400">85%</div>
                            <div class="w-full h-1 bg-green-900/50 rounded mt-1">
                                <div class="h-full bg-green-500 rounded" style="width: 85%"></div>
                            </div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-red-900/30 border border-red-500/30">
                            <div class="text-2xl mb-1">火</div>
                            <div id="fireVal" class="text-xs text-red-400">60%</div>
                            <div class="w-full h-1 bg-red-900/50 rounded mt-1">
                                <div class="h-full bg-red-500 rounded" style="width: 60%"></div>
                            </div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-yellow-900/30 border border-yellow-500/30">
                            <div class="text-2xl mb-1">土</div>
                            <div id="earthVal" class="text-xs text-yellow-400">45%</div>
                            <div class="w-full h-1 bg-yellow-900/50 rounded mt-1">
                                <div class="h-full bg-yellow-500 rounded" style="width: 45%"></div>
                            </div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-gray-700/30 border border-gray-400/30">
                            <div class="text-2xl mb-1">金</div>
                            <div id="metalVal" class="text-xs text-gray-300">70%</div>
                            <div class="w-full h-1 bg-gray-600/50 rounded mt-1">
                                <div class="h-full bg-gray-400 rounded" style="width: 70%"></div>
                            </div>
                        </div>
                        <div class="text-center p-2 rounded-lg bg-blue-900/30 border border-blue-500/30">
                            <div class="text-2xl mb-1">水</div>
                            <div id="waterVal" class="text-xs text-blue-400">55%</div>
                            <div class="w-full h-1 bg-blue-900/50 rounded mt-1">
                                <div class="h-full bg-blue-500 rounded" style="width: 55%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>
            
            <!-- 中间日历区 -->
            <main class="lg:col-span-6">
                <!-- 日期选择器 -->
                <div class="glass rounded-2xl p-6 mb-6 glow-effect">
                    <div class="flex items-center justify-between mb-6">
                        <button onclick="changeMonth(-1)" class="p-3 rounded-full bg-gold/10 hover:bg-gold/20 transition-all border border-gold/30 hover:border-gold/50">
                            <i class="fas fa-chevron-left text-gold"></i>
                        </button>
                        <div class="text-center">
                            <h2 id="currentYear" class="ancient-font text-3xl text-gold">甲辰年</h2>
                            <p id="currentMonth" class="text-bronze text-lg">腊月</p>
                        </div>
                        <button onclick="changeMonth(1)" class="p-3 rounded-full bg-gold/10 hover:bg-gold/20 transition-all border border-gold/30 hover:border-gold/50">
                            <i class="fas fa-chevron-right text-gold"></i>
                        </button>
                    </div>
                    
                    <!-- 星期标题 -->
                    <div class="grid grid-cols-7 gap-2 mb-4">
                        <div class="text-center text-cinnabar ancient-font">日</div>
                        <div class="text-center text-gold/70">一</div>
                        <div class="text-center text-gold/70">二</div>
                        <div class="text-center text-gold/70">三</div>
                        <div class="text-center text-gold/70">四</div>
                        <div class="text-center text-gold/70">五</div>
                        <div class="text-center text-cinnabar ancient-font">六</div>
                    </div>
                    
                    <!-- 日历格子 -->
                    <div id="calendarGrid" class="grid grid-cols-7 gap-2">
                        <!-- 由JS生成 -->
                    </div>
                </div>
                
                <!-- 今日详情 -->
                <div class="glass rounded-2xl p-6 glow-effect">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="ancient-font text-2xl text-gold">今日详情</h3>
                        <button onclick="goToToday()" class="px-4 py-2 rounded-lg bg-cinnabar/20 hover:bg-cinnabar/30 text-cinnabar border border-cinnabar/30 transition-all text-sm">
                            <i class="fas fa-calendar-day mr-2"></i>回到今日
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 公历农历 -->
                        <div class="bg-obsidian/50 rounded-xl p-4 border border-gold/20">
                            <div class="text-center mb-4">
                                <div id="solarDate" class="ancient-font text-4xl text-gold mb-2">2024年12月25日</div>
                                <div id="lunarDate" class="text-xl text-bronze">农历甲辰年 腊月廿五</div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-center text-sm">
                                <div class="p-2 rounded-lg bg-gold/5 border border-gold/10">
                                    <div class="text-gold/70">生肖</div>
                                    <div id="zodiac" class="text-gold text-lg">龙</div>
                                </div>
                                <div class="p-2 rounded-lg bg-gold/5 border border-gold/10">
                                    <div class="text-gold/70">星座</div>
                                    <div id="constellation" class="text-gold text-lg">摩羯座</div>
                                </div>
                                <div class="p-2 rounded-lg bg-gold/5 border border-gold/10">
                                    <div class="text-gold/70">节气</div>
                                    <div id="solarTerm" class="text-gold text-lg">冬至</div>
                                </div>
                                <div class="p-2 rounded-lg bg-gold/5 border border-gold/10">
                                    <div class="text-gold/70">值神</div>
                                    <div id="valueGod" class="text-gold text-lg">青龙</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 宜忌 -->
                        <div class="space-y-4">
                            <div class="bg-jade/10 rounded-xl p-4 border border-jade/30">
                                <div class="flex items-center mb-2">
                                    <span class="w-8 h-8 rounded-full bg-jade/20 flex items-center justify-center text-jade mr-2">宜</span>
                                    <span class="text-jade">今日宜事</span>
                                </div>
                                <div id="yiList" class="flex flex-wrap gap-2">
                                    <span class="px-3 py-1 rounded-full bg-jade/20 text-jade/90 text-sm">祭祀</span>
                                    <span class="px-3 py-1 rounded-full bg-jade/20 text-jade/90 text-sm">祈福</span>
                                    <span class="px-3 py-1 rounded-full bg-jade/20 text-jade/90 text-sm">出行</span>
                                    <span class="px-3 py-1 rounded-full bg-jade/20 text-jade/90 text-sm">纳财</span>
                                </div>
                            </div>
                            <div class="bg-cinnabar/10 rounded-xl p-4 border border-cinnabar/30">
                                <div class="flex items-center mb-2">
                                    <span class="w-8 h-8 rounded-full bg-cinnabar/20 flex items-center justify-center text-cinnabar mr-2">忌</span>
                                    <span class="text-cinnabar">今日忌事</span>
                                </div>
                                <div id="jiList" class="flex flex-wrap gap-2">
                                    <span class="px-3 py-1 rounded-full bg-cinnabar/20 text-cinnabar/90 text-sm">动土</span>
                                    <span class="px-3 py-1 rounded-full bg-cinnabar/20 text-cinnabar/90 text-sm">安葬</span>
                                    <span class="px-3 py-1 rounded-full bg-cinnabar/20 text-cinnabar/90 text-sm">开仓</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- 右侧信息区 -->
            <aside class="lg:col-span-3 space-y-6">
                <!-- 吉时查询 -->
                <div class="glass rounded-2xl p-6 glow-effect">
                    <h3 class="text-gold text-center mb-4 ancient-font text-xl">今日吉时</h3>
                    <div id="luckyHours" class="space-y-2">
                        <div class="flex items-center justify-between p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <span class="text-gold">子时</span>
                            <span class="text-parchment/70 text-sm">23:00-01:00</span>
                            <span class="text-jade text-sm">大吉</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <span class="text-gold">卯时</span>
                            <span class="text-parchment/70 text-sm">05:00-07:00</span>
                            <span class="text-jade text-sm">大吉</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <span class="text-gold">午时</span>
                            <span class="text-parchment/70 text-sm">11:00-13:00</span>
                            <span class="text-bronze text-sm">中吉</span>
                        </div>
                        <div class="flex items-center justify-between p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <span class="text-gold">酉时</span>
                            <span class="text-parchment/70 text-sm">17:00-19:00</span>
                            <span class="text-bronze text-sm">中吉</span>
                        </div>
                    </div>
                </div>
                
                <!-- 方位吉凶 -->
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-gold text-center mb-4 ancient-font text-xl">方位宜忌</h3>
                    <div class="relative w-full aspect-square max-w-[200px] mx-auto">
                        <!-- 罗盘 -->
                        <div class="absolute inset-0 rounded-full border-2 border-gold/30 flex items-center justify-center">
                            <div class="w-3/4 h-3/4 rounded-full border border-gold/20 relative">
                                <!-- 方位标记 -->
                                <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 px-2 py-1 bg-cinnabar/80 rounded text-xs">南</div>
                                <div class="absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-1/2 px-2 py-1 bg-gold/80 rounded text-xs text-obsidian">北</div>
                                <div class="absolute left-0 top-1/2 -translate-x-1/2 -translate-y-1/2 px-2 py-1 bg-gold/80 rounded text-xs text-obsidian">西</div>
                                <div class="absolute right-0 top-1/2 translate-x-1/2 -translate-y-1/2 px-2 py-1 bg-jade/80 rounded text-xs">东</div>
                                
                                <!-- 中心指针 -->
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="w-2 h-16 bg-gradient-to-b from-cinnabar to-gold rounded-full"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-jade">喜神方位</span>
                            <span id="joyDirection" class="text-gold">东南</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-jade">财神方位</span>
                            <span id="wealthDirection" class="text-gold">正南</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-cinnabar">煞神方位</span>
                            <span id="evilDirection" class="text-parchment/70">正北</span>
                        </div>
                    </div>
                </div>
                
                <!-- 节日提醒 -->
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-gold text-center mb-4 ancient-font text-xl">近期节日</h3>
                    <div id="festivals" class="space-y-3">
                        <div class="p-3 rounded-lg bg-cinnabar/10 border border-cinnabar/20">
                            <div class="flex items-center justify-between">
                                <span class="text-cinnabar">元旦</span>
                                <span class="text-xs text-parchment/50">7天后</span>
                            </div>
                        </div>
                        <div class="p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <div class="flex items-center justify-between">
                                <span class="text-gold">腊八节</span>
                                <span class="text-xs text-parchment/50">13天后</span>
                            </div>
                        </div>
                        <div class="p-3 rounded-lg bg-gold/5 border border-gold/10">
                            <div class="flex items-center justify-between">
                                <span class="text-gold">小年</span>
                                <span class="text-xs text-parchment/50">28天后</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 每日一言 -->
                <div class="glass rounded-2xl p-6 seal-stamp">
                    <h3 class="text-gold text-center mb-4 ancient-font text-xl">每日一言</h3>
                    <blockquote id="dailyQuote" class="text-center text-parchment/80 italic leading-relaxed">
                        "积善之家，必有余庆；积不善之家，必有余殃。"
                    </blockquote>
                    <p class="text-right text-bronze text-sm mt-2">——《易经》</p>
                </div>
            </aside>
        </div>
        
        <!-- 底部功能区 -->
        <section class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- 生辰八字 -->
            <div class="glass rounded-2xl p-6">
                <h3 class="text-gold text-center mb-4 ancient-font text-xl">
                    <i class="fas fa-yin-yang mr-2"></i>生辰八字
                </h3>
                <div class="space-y-4">
                    <div>
                        <label class="text-parchment/70 text-sm block mb-2">出生日期</label>
                        <input type="date" id="birthDate" class="w-full bg-obsidian/50 border border-gold/30 rounded-lg px-4 py-2 text-parchment focus:border-gold focus:outline-none">
                    </div>
                    <div>
                        <label class="text-parchment/70 text-sm block mb-2">出生时辰</label>
                        <select id="birthHour" class="w-full bg-obsidian/50 border border-gold/30 rounded-lg px-4 py-2 text-parchment focus:border-gold focus:outline-none">
                            <option value="zi">子时 (23:00-01:00)</option>
                            <option value="chou">丑时 (01:00-03:00)</option>
                            <option value="yin">寅时 (03:00-05:00)</option>
                            <option value="mao">卯时 (05:00-07:00)</option>
                            <option value="chen">辰时 (07:00-09:00)</option>
                            <option value="si">巳时 (09:00-11:00)</option>
                            <option value="wu">午时 (11:00-13:00)</option>
                            <option value="wei">未时 (13:00-15:00)</option>
                            <option value="shen">申时 (15:00-17:00)</option>
                            <option value="you">酉时 (17:00-19:00)</option>
                            <option value="xu">戌时 (19:00-21:00)</option>
                            <option value="hai">亥时 (21:00-23:00)</option>
                        </select>
                    </div>
                    <button onclick="calculateBazi()" class="w-full py-3 rounded-lg bg-gradient-to-r from-gold/20 to-bronze/20 border border-gold/30 text-gold hover:from-gold/30 hover:to-bronze/30 transition-all">
                        推算八字
                    </button>
                    <div id="baziResult" class="hidden p-4 rounded-lg bg-obsidian/50 border border-gold/20">
                        <div class="text-center">
                            <div class="text-gold/70 text-sm mb-2">您的八字</div>
                            <div id="baziText" class="ancient-font text-2xl text-gold"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 黄历查询 -->
            <div class="glass rounded-2xl p-6">
                <h3 class="text-gold text-center mb-4 ancient-font text-xl">
                    <i class="fas fa-calendar-alt mr-2"></i>黄历查询
                </h3>
                <div class="space-y-4">
                    <div>
                        <label class="text-parchment/70 text-sm block mb-2">选择日期</label>
                        <input type="date" id="queryDate" class="w-full bg-obsidian/50 border border-gold/30 rounded-lg px-4 py-2 text-parchment focus:border-gold focus:outline-none">
                    </div>
                    <button onclick="queryHuangli()" class="w-full py-3 rounded-lg bg-gradient-to-r from-gold/20 to-bronze/20 border border-gold/30 text-gold hover:from-gold/30 hover:to-bronze/30 transition-all">
                        查询黄历
                    </button>
                    <div id="queryResult" class="hidden space-y-2 text-sm">
                        <div class="flex justify-between p-2 rounded bg-obsidian/30">
                            <span class="text-gold/70">农历</span>
                            <span id="queryLunar" class="text-parchment"></span>
                        </div>
                        <div class="flex justify-between p-2 rounded bg-obsidian/30">
                            <span class="text-gold/70">宜</span>
                            <span id="queryYi" class="text-jade"></span>
                        </div>
                        <div class="flex justify-between p-2 rounded bg-obsidian/30">
                            <span class="text-gold/70">忌</span>
                            <span id="queryJi" class="text-cinnabar"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 吉日挑选 -->
            <div class="glass rounded-2xl p-6">
                <h3 class="text-gold text-center mb-4 ancient-font text-xl">
                    <i class="fas fa-star mr-2"></i>吉日挑选
                </h3>
                <div class="space-y-4">
                    <div>
                        <label class="text-parchment/70 text-sm block mb-2">选择事项</label>
                        <select id="eventType" class="w-full bg-obsidian/50 border border-gold/30 rounded-lg px-4 py-2 text-parchment focus:border-gold focus:outline-none">
                            <option value="marriage">嫁娶</option>
                            <option value="move">搬家</option>
                            <option value="open">开业</option>
                            <option value="travel">出行</option>
                            <option value="burial">安葬</option>
                            <option value="groundbreaking">动土</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-parchment/70 text-sm block mb-2">选择月份</label>
                        <input type="month" id="targetMonth" class="w-full bg-obsidian/50 border border-gold/30 rounded-lg px-4 py-2 text-parchment focus:border-gold focus:outline-none">
                    </div>
                    <button onclick="findLuckyDays()" class="w-full py-3 rounded-lg bg-gradient-to-r from-gold/20 to-bronze/20 border border-gold/30 text-gold hover:from-gold/30 hover:to-bronze/30 transition-all">
                        查找吉日
                    </button>
                    <div id="luckyDaysResult" class="hidden space-y-2">
                        <div class="text-gold/70 text-sm text-center mb-2">本月吉日</div>
                        <div id="luckyDaysList" class="flex flex-wrap gap-2 justify-center"></div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 页脚 -->
        <footer class="mt-12 text-center py-6 border-t border-gold/10">
            <p class="text-gold/50 text-sm">玄机黄历 · 传承千年智慧</p>
            <p class="text-parchment/30 text-xs mt-2">仅供参考，切勿迷信</p>
        </footer>
    </div>
    
    <!-- 详情弹窗 -->
    <div id="detailModal" class="fixed inset-0 bg-obsidian/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="glass rounded-2xl p-6 max-w-md w-full max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="ancient-font text-2xl text-gold">日期详情</h3>
                <button onclick="closeModal()" class="text-gold/70 hover:text-gold">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="modalContent" class="space-y-4">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <script>
        // 天干地支
        const tianGan = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
        const diZhi = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
        const shengXiao = ['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'];
        const lunarMonths = ['正', '二', '三', '四', '五', '六', '七', '八', '九', '十', '冬', '腊'];
        const lunarDays = ['初一', '初二', '初三', '初四', '初五', '初六', '初七', '初八', '初九', '初十',
                          '十一', '十二', '十三', '十四', '十五', '十六', '十七', '十八', '十九', '二十',
                          '廿一', '廿二', '廿三', '廿四', '廿五', '廿六', '廿七', '廿八', '廿九', '三十'];
        
        // 八卦
        const bagua = ['乾', '坤', '震', '巽', '坎', '离', '艮', '兑'];
        const guaCi = {
            '乾': '天行健，君子以自强不息',
            '坤': '地势坤，君子以厚德载物',
            '震': '震惊百里，不丧匕鬯',
            '巽': '随风巽，君子以申命行事',
            '坎': '水流而不盈，行险而不失其信',
            '离': '明两作离，大人以继明照于四方',
            '艮': '时止则止，时行则行',
            '兑': '丽泽兑，君子以朋友讲习'
        };
        
        // 宜忌事项
        const yiItems = ['祭祀', '祈福', '求嗣', '开光', '出行', '解除', '纳采', '冠笄', '嫁娶', '纳婿',
                        '安床', '移徙', '入宅', '安香', '拆卸', '动土', '挂匾', '开市', '立券', '纳财',
                        '沐浴', '理发', '安门', '修造', '盖屋', '合脊', '起基', '定磉', '安碓硙', '放水',
                        '掘井', '破土', '安葬', '启钻', '除服', '成服', '开生坟', '合寿木', '入殓', '移柩'];
        
        const jiItems = ['嫁娶', '安葬', '出行', '动土', '开市', '入宅', '移徙', '祭祀', '祈福', '开光',
                        '纳采', '安床', '掘井', '破土', '安门', '作灶', '盖屋', '竖柱', '上梁', '栽种'];
        
        // 每日一言
        const quotes = [
            { text: '积善之家，必有余庆；积不善之家，必有余殃。', source: '《易经》' },
            { text: '天行健，君子以自强不息。', source: '《易经》' },
            { text: '地势坤，君子以厚德载物。', source: '《易经》' },
            { text: '穷则变，变则通，通则久。', source: '《易经》' },
            { text: '仁者见之谓之仁，知者见之谓之知。', source: '《易经》' },
            { text: '君子藏器于身，待时而动。', source: '《易经》' },
            { text: '善不积不足以成名，恶不积不足以灭身。', source: '《易经》' },
            { text: '谦谦君子，用涉大川。', source: '《易经》' }
        ];
        
        // 当前显示的年月
        let displayYear = new Date().getFullYear();
        let displayMonth = new Date().getMonth();
        let selectedDate = new Date();
        
        // 农历数据（简化版）
        const lunarInfo = [
            0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,
            0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,
            0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,
            0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,
            0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,
            0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,
            0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,
            0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,
            0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,
            0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,
            0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,
            0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,
            0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,
            0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,
            0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0,
            0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 0x0aae0,
            0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4,
            0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0,
            0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160,
            0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252,
            0x0d520
        ];
        
        // 节气数据
        const solarTerms = [
            '小寒', '大寒', '立春', '雨水', '惊蛰', '春分',
            '清明', '谷雨', '立夏', '小满', '芒种', '夏至',
            '小暑', '大暑', '立秋', '处暑', '白露', '秋分',
            '寒露', '霜降', '立冬', '小雪', '大雪', '冬至'
        ];
        
        // 星座
        const constellations = [
            { name: '摩羯座', start: [1, 1], end: [1, 19] },
            { name: '水瓶座', start: [1, 20], end: [2, 18] },
            { name: '双鱼座', start: [2, 19], end: [3, 20] },
            { name: '白羊座', start: [3, 21], end: [4, 19] },
            { name: '金牛座', start: [4, 20], end: [5, 20] },
            { name: '双子座', start: [5, 21], end: [6, 21] },
            { name: '巨蟹座', start: [6, 22], end: [7, 22] },
            { name: '狮子座', start: [7, 23], end: [8, 22] },
            { name: '处女座', start: [8, 23], end: [9, 22] },
            { name: '天秤座', start: [9, 23], end: [10, 23] },
            { name: '天蝎座', start: [10, 24], end: [11, 22] },
            { name: '射手座', start: [11, 23], end: [12, 21] },
            { name: '摩羯座', start: [12, 22], end: [12, 31] }
        ];
        
        // 初始化星空背景
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star absolute rounded-full bg-parchment';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }
        
        // 农历计算
        function getLunarMonthDays(year, month) {
            return (lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;
        }
        
        function getLunarYearDays(year) {
            let sum = 348;
            for (let i = 0x8000; i > 0x8; i >>= 1) {
                sum += (lunarInfo[year - 1900] & i) ? 1 : 0;
            }
            return sum + getLeapMonthDays(year);
        }
        
        function getLeapMonth(year) {
            return lunarInfo[year - 1900] & 0xf;
        }
        
        function getLeapMonthDays(year) {
            if (getLeapMonth(year)) {
                return (lunarInfo[year - 1900] & 0x10000) ? 30 : 29;
            }
            return 0;
        }
        
        function solarToLunar(year, month, day) {
            // 简化的农历转换
            const baseDate = new Date(1900, 0, 31);
            const targetDate = new Date(year, month - 1, day);
            let offset = Math.floor((targetDate - baseDate) / 86400000);
            
            let lunarYear = 1900;
            let lunarMonth = 1;
            let lunarDay = 1;
            let isLeap = false;
            
            // 计算年
            let yearDays = 0;
            while (lunarYear < 2100 && offset > 0) {
                yearDays = getLunarYearDays(lunarYear);
                if (offset < yearDays) break;
                offset -= yearDays;
                lunarYear++;
            }
            
            // 计算月
            let leapMonth = getLeapMonth(lunarYear);
            let monthDays = 0;
            
            for (let i = 1; i <= 12; i++) {
                if (leapMonth > 0 && i === leapMonth + 1 && !isLeap) {
                    monthDays = getLeapMonthDays(lunarYear);
                    isLeap = true;
                    i--;
                } else {
                    monthDays = getLunarMonthDays(lunarYear, i);
                    isLeap = false;
                }
                
                if (offset < monthDays) {
                    lunarMonth = i;
                    break;
                }
                offset -= monthDays;
            }
            
            lunarDay = offset + 1;
            
            return {
                year: lunarYear,
                month: lunarMonth,
                day: lunarDay,
                isLeap: isLeap
            };
        }
        
        // 获取天干地支年
        function getGanZhiYear(year) {
            const ganIndex = (year - 4) % 10;
            const zhiIndex = (year - 4) % 12;
            return tianGan[ganIndex] + diZhi[zhiIndex];
        }
        
        // 获取生肖
        function getZodiac(year) {
            return shengXiao[(year - 4) % 12];
        }
        
        // 获取星座
        function getConstellation(month, day) {
            for (const c of constellations) {
                if ((month === c.start[0] && day >= c.start[1]) ||
                    (month === c.end[0] && day <= c.end[1])) {
                    return c.name;
                }
            }
            return constellations[0].name;
        }
        
        // 获取节气
        function getSolarTerm(month, day) {
            const termIndex = (month - 1) * 2;
            return solarTerms[termIndex] || '';
        }
        
        // 生成随机宜忌
        function generateYiJi(seed) {
            const random = (s) => {
                const x = Math.sin(s) * 10000;
                return x - Math.floor(x);
            };
            
            const yiCount = Math.floor(random(seed) * 5) + 3;
            const jiCount = Math.floor(random(seed + 1) * 4) + 2;
            
            const shuffledYi = [...yiItems].sort(() => random(seed + 2) - 0.5);
            const shuffledJi = [...jiItems].sort(() => random(seed + 3) - 0.5);
            
            return {
                yi: shuffledYi.slice(0, yiCount),
                ji: shuffledJi.slice(0, jiCount)
            };
        }
        
        // 获取今日卦象
        function getTodayGua(date) {
            const seed = date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate();
            const index = Math.floor((Math.sin(seed) * 10000) % 8);
            return bagua[Math.abs(index)];
        }
        
        // 渲染日历
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            const firstDay = new Date(displayYear, displayMonth, 1);
            const lastDay = new Date(displayYear, displayMonth + 1, 0);
            const startDay = firstDay.getDay();
            const totalDays = lastDay.getDate();
            
            // 更新标题
            document.getElementById('currentYear').textContent = getGanZhiYear(displayYear) + '年';
            document.getElementById('currentMonth').textContent = lunarMonths[displayMonth] + '月';
            
            // 填充空白
            for (let i = 0; i < startDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'aspect-square';
                grid.appendChild(emptyCell);
            }
            
            // 填充日期
            const today = new Date();
            for (let day = 1; day <= totalDays; day++) {
                const cell = document.createElement('div');
                const currentDate = new Date(displayYear, displayMonth, day);
                const lunar = solarToLunar(displayYear, displayMonth + 1, day);
                const isToday = currentDate.toDateString() === today.toDateString();
                const isWeekend = currentDate.getDay() === 0 || currentDate.getDay() === 6;
                
                cell.className = `day-cell aspect-square rounded-xl p-1 cursor-pointer flex flex-col items-center justify-center
                    ${isToday ? 'bg-cinnabar/30 border-2 border-cinnabar glow-effect' : 'bg-obsidian/30 border border-gold/20 hover:border-gold/50'}
                    ${isWeekend ? 'text-cinnabar' : 'text-parchment'}`;
                
                cell.innerHTML = `
                    <span class="text-lg ${isToday ? 'text-gold ancient-font' : ''}">${day}</span>
                    <span class="text-xs text-gold/50">${lunarDays[lunar.day - 1]}</span>
                `;
                
                cell.onclick = () => showDayDetail(currentDate);
                grid.appendChild(cell);
            }
        }
        
        // 显示日期详情
        function showDayDetail(date) {
            selectedDate = date;
            updateDayInfo(date);
            
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            const lunar = solarToLunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
            const yiji = generateYiJi(date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate());
            
            document.getElementById('modalTitle').textContent = 
                `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
            
            content.innerHTML = `
                <div class="text-center mb-4">
                    <div class="text-bronze">农历${getGanZhiYear(lunar.year)}年 ${lunarMonths[lunar.month - 1]}月${lunarDays[lunar.day - 1]}</div>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="p-3 rounded-lg bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-gold/70 text-sm">生肖</div>
                        <div class="text-gold text-xl">${getZodiac(lunar.year)}</div>
                    </div>
                    <div class="p-3 rounded-lg bg-obsidian/50 border border-gold/20 text-center">
                        <div class="text-gold/70 text-sm">星座</div>
                        <div class="text-gold text-xl">${getConstellation(date.getMonth() + 1, date.getDate())}</div>
                    </div>
                </div>
                <div class="bg-jade/10 rounded-lg p-3 border border-jade/30 mb-3">
                    <div class="text-jade mb-2">宜</div>
                    <div class="flex flex-wrap gap-2">
                        ${yiji.yi.map(y => `<span class="px-2 py-1 rounded bg-jade/20 text-jade/90 text-sm">${y}</span>`).join('')}
                    </div>
                </div>
                <div class="bg-cinnabar/10 rounded-lg p-3 border border-cinnabar/30">
                    <div class="text-cinnabar mb-2">忌</div>
                    <div class="flex flex-wrap gap-2">
                        ${yiji.ji.map(j => `<span class="px-2 py-1 rounded bg-cinnabar/20 text-cinnabar/90 text-sm">${j}</span>`).join('')}
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }
        
        // 关闭弹窗
        function closeModal() {
            document.getElementById('detailModal').classList.add('hidden');
        }
        
        // 更新今日信息
        function updateDayInfo(date) {
            const lunar = solarToLunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
            const yiji = generateYiJi(date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate());
            const gua = getTodayGua(date);
            
            // 更新日期显示
            document.getElementById('solarDate').textContent = 
                `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
            document.getElementById('lunarDate').textContent = 
                `农历${getGanZhiYear(lunar.year)}年 ${lunarMonths[lunar.month - 1]}月${lunarDays[lunar.day - 1]}`;
            
            // 更新生肖星座
            document.getElementById('zodiac').textContent = getZodiac(lunar.year);
            document.getElementById('constellation').textContent = getConstellation(date.getMonth() + 1, date.getDate());
            document.getElementById('solarTerm').textContent = getSolarTerm(date.getMonth() + 1, date.getDate());
            
            // 更新宜忌
            document.getElementById('yiList').innerHTML = yiji.yi
                .map(y => `<span class="px-3 py-1 rounded-full bg-jade/20 text-jade/90 text-sm">${y}</span>`)
                .join('');
            document.getElementById('jiList').innerHTML = yiji.ji
                .map(j => `<span class="px-3 py-1 rounded-full bg-cinnabar/20 text-cinnabar/90 text-sm">${j}</span>`)
                .join('');
            
            // 更新卦象
            document.getElementById('todayGua').textContent = gua;
            document.getElementById('guaCi').textContent = guaCi[gua];
            
            // 更新值神
            const zhiShen = ['青龙', '明堂', '天刑', '朱雀', '金匮', '天德', '白虎', '玉堂', '天牢', '玄武', '司命', '勾陈'];
            document.getElementById('valueGod').textContent = zhiShen[(date.getDay() + date.getDate()) % 12];
            
            // 更新方位
            const directions = ['正东', '东南', '正南', '西南', '正西', '西北', '正北', '东北'];
            document.getElementById('joyDirection').textContent = directions[(date.getDate() + 2) % 8];
            document.getElementById('wealthDirection').textContent = directions[(date.getDate() + 4) % 8];
            document.getElementById('evilDirection').textContent = directions[(date.getDate() + 6) % 8];
            
            // 更新五行能量
            updateWuxingEnergy(date);
        }
        
        // 更新五行能量
        function updateWuxingEnergy(date) {
            const seed = date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate();
            const elements = ['wood', 'fire', 'earth', 'metal', 'water'];
            
            elements.forEach((el, i) => {
                const val = Math.floor((Math.sin(seed + i) * 10000) % 50) + 50;
                document.getElementById(el + 'Val').textContent = val + '%';
                document.getElementById(el + 'Val').parentElement.querySelector('.h-full').style.width = val + '%';
            });
        }
        
        // 切换月份
        function changeMonth(delta) {
            displayMonth += delta;
            if (displayMonth > 11) {
                displayMonth = 0;
                displayYear++;
            } else if (displayMonth < 0) {
                displayMonth = 11;
                displayYear--;
            }
            renderCalendar();
        }
        
        // 回到今日
        function goToToday() {
            const today = new Date();
            displayYear = today.getFullYear();
            displayMonth = today.getMonth();
            selectedDate = today;
            renderCalendar();
            updateDayInfo(today);
        }
        
        // 计算八字
        function calculateBazi() {
            const birthDate = document.getElementById('birthDate').value;
            const birthHour = document.getElementById('birthHour').value;
            
            if (!birthDate) {
                alert('请选择出生日期');
                return;
            }
            
            const date = new Date(birthDate);
            const lunar = solarToLunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
            
            // 简化的八字计算
            const yearGan = tianGan[(lunar.year - 4) % 10];
            const yearZhi = diZhi[(lunar.year - 4) % 12];
            
            const monthGan = tianGan[(lunar.year * 12 + lunar.month + 2) % 10];
            const monthZhi = diZhi[(lunar.month + 1) % 12];
            
            const dayGan = tianGan[(date.getDate() + 5) % 10];
            const dayZhi = diZhi[(date.getDate() + 5) % 12];
            
            const hourZhiMap = { zi: 0, chou: 1, yin: 2, mao: 3, chen: 4, si: 5, wu: 6, wei: 7, shen: 8, you: 9, xu: 10, hai: 11 };
            const hourIndex = hourZhiMap[birthHour];
            const hourGan = tianGan[(date.getDate() * 2 + hourIndex) % 10];
            const hourZhi = diZhi[hourIndex];
            
            const bazi = `${yearGan}${yearZhi} ${monthGan}${monthZhi} ${dayGan}${dayZhi} ${hourGan}${hourZhi}`;
            
            document.getElementById('baziText').textContent = bazi;
            document.getElementById('baziResult').classList.remove('hidden');
        }
        
        // 查询黄历
        function queryHuangli() {
            const queryDate = document.getElementById('queryDate').value;
            
            if (!queryDate) {
                alert('请选择查询日期');
                return;
            }
            
            const date = new Date(queryDate);
            const lunar = solarToLunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
            const yiji = generateYiJi(date.getFullYear() * 10000 + (date.getMonth() + 1) * 100 + date.getDate());
            
            document.getElementById('queryLunar').textContent = 
                `${getGanZhiYear(lunar.year)}年${lunarMonths[lunar.month - 1]}月${lunarDays[lunar.day - 1]}`;
            document.getElementById('queryYi').textContent = yiji.yi.join('、');
            document.getElementById('queryJi').textContent = yiji.ji.join('、');
            document.getElementById('queryResult').classList.remove('hidden');
        }
        
        // 查找吉日
        function findLuckyDays() {
            const eventType = document.getElementById('eventType').value;
            const targetMonth = document.getElementById('targetMonth').value;
            
            if (!targetMonth) {
                alert('请选择月份');
                return;
            }
            
            const [year, month] = targetMonth.split('-').map(Number);
            const daysInMonth = new Date(year, month, 0).getDate();
            const luckyDays = [];
            
            for (let day = 1; day <= daysInMonth; day++) {
                const seed = year * 10000 + month * 100 + day;
                const random = Math.sin(seed) * 10000;
                if (random - Math.floor(random) > 0.7) {
                    luckyDays.push(day);
                }
            }
            
            document.getElementById('luckyDaysList').innerHTML = luckyDays
                .map(d => `<span class="px-3 py-1 rounded-full bg-jade/20 text-jade text-sm">${d}日</span>`)
                .join('');
            document.getElementById('luckyDaysResult').classList.remove('hidden');
        }
        
        // 更新每日一言
        function updateDailyQuote() {
            const today = new Date();
            const index = (today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate()) % quotes.length;
            const quote = quotes[index];
            
            document.getElementById('dailyQuote').textContent = `"${quote.text}"`;
            document.getElementById('dailyQuote').nextElementSibling.textContent = `——${quote.source}`;
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            renderCalendar();
            updateDayInfo(new Date());
            updateDailyQuote();
            
            // 设置默认值
            document.getElementById('queryDate').valueAsDate = new Date();
            document.getElementById('targetMonth').value = 
                `${new Date().getFullYear()}-${String(new Date().getMonth() + 1).padStart(2, '0')}`;
        });
        
        // 点击弹窗外部关闭
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
